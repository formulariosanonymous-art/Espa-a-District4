<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Espa√±a District | Portal Oficial</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { 
            --primary: #2575fc; --bg: #0b0f1a; --card-bg: rgba(30, 41, 59, 0.5);
            --text: #f1f5f9; --norms: #6366f1; --gov: #f59e0b; --danger: #ef4444;
            --success: #10b981;
        }

        body { 
            margin: 0; font-family: 'Plus Jakarta Sans', sans-serif; 
            background: var(--bg); color: var(--text); overflow-x: hidden;
            user-select: none;
        }

        /* HEADER */
        .header { 
            position: fixed; top: 0; width: 100%; height: 70px; 
            background: rgba(11, 15, 26, 0.8); backdrop-filter: blur(15px); 
            display: flex; align-items: center; justify-content: space-between; 
            padding: 0 20px; box-sizing: border-box; z-index: 1000; border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .view { display: none; flex-direction: column; align-items: center; padding: 100px 20px; min-height: 100vh; box-sizing: border-box; }
        .view.active { display: flex; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* ACORDE√ìN */
        .accordion { width: 100%; max-width: 800px; margin-bottom: 12px; border-radius: 15px; background: var(--card-bg); border: 1px solid rgba(255,255,255,0.05); overflow: hidden; }
        .acc-header { padding: 20px; cursor: pointer; display: flex; justify-content: space-between; font-weight: 800; transition: 0.3s; }
        .acc-content { max-height: 0; overflow: hidden; transition: 0.4s ease-out; background: rgba(0,0,0,0.2); }
        .accordion.open .acc-content { max-height: 5000px; }
        .accordion.open .acc-header { border-bottom: 1px solid rgba(255,255,255,0.05); background: rgba(255,255,255,0.02); }

        .acc-norms { border-left: 5px solid var(--norms); }
        .acc-gov { border-left: 5px solid var(--gov); }

        /* BOTONES */
        .btn { border: none; border-radius: 10px; font-weight: 700; cursor: pointer; padding: 12px 20px; color: white; transition: 0.2s; display: inline-flex; align-items: center; justify-content: center; }
        .btn-primary { background: linear-gradient(135deg, #6a11cb, var(--primary)); }
        .btn-danger { background: var(--danger); }
        .btn-small { padding: 6px 12px; font-size: 11px; }

        input, textarea, select { width: 100%; padding: 12px; margin: 8px 0; border-radius: 10px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03); color: white; box-sizing: border-box; outline: none; }

        .overlay { position: fixed; inset: 0; background: var(--bg); z-index: 2000; display: none; align-items: center; justify-content: center; padding: 20px; }
        .glass { background: #161c2d; padding: 30px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); width: 100%; max-width: 350px; text-align: center; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }

        .admin-card { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 12px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; width: 100%; border: 1px solid rgba(255,255,255,0.05); }
    </style>
</head>
<body oncontextmenu="return false">

    <header class="header">
        <div style="font-weight: 800; letter-spacing: 1px;">ESPA√ëA DISTRICT</div>
        <div style="display:flex; gap:10px;">
            <button class="btn btn-primary" style="padding:8px 15px; font-size:11px;" onclick="showView('home')">INICIO</button>
            <button class="btn" style="padding:8px 15px; font-size:11px; background:rgba(255,255,255,0.1);" onclick="openGate()">STAFF</button>
        </div>
    </header>

    <section id="view-home" class="view active">
        <h1 style="font-size: 40px; margin-bottom: 10px; text-align: center;">Portal de Informaci√≥n</h1>
        <p style="color: #94a3b8; margin-bottom: 40px; text-align: center;">Consulta las leyes y departamentos del servidor.</p>
        <div style="display:flex; gap:15px; flex-wrap: wrap; justify-content: center;">
            <button class="btn" style="background:var(--norms); width: 180px; height: 60px;" onclick="showView('norms')">NORMAS</button>
            <button class="btn" style="background:var(--gov); width: 180px; height: 60px;" onclick="showView('gov')">GOBIERNO</button>
        </div>
    </section>

    <section id="view-norms" class="view">
        <h2 style="color:var(--norms)">üìú Normativas</h2>
        <div id="render-norms" style="width:100%; display:flex; flex-direction:column; align-items:center;"></div>
    </section>

    <section id="view-gov" class="view">
        <h2 style="color:var(--gov)">üèõÔ∏è Gobierno</h2>
        <div id="render-gov" style="width:100%; display:flex; flex-direction:column; align-items:center;"></div>
    </section>

    <section id="view-admin" class="view">
        <div style="display:flex; gap:10px; margin-bottom:25px; overflow-x:auto; width:100%; max-width:800px; padding: 5px;">
            <button class="btn btn-primary" onclick="switchTab('t-add')">A√±adir</button>
            <button class="btn" style="background:#334155;" onclick="switchTab('t-manage')">Gestionar</button>
            <button class="btn" style="background:#1e293b;" onclick="askStaffPass()">Staff / Webhook</button>
            <button class="btn btn-danger" onclick="logout()">Salir</button>
        </div>

        <div id="t-add" class="tab-content" style="width:100%; max-width:800px;">
            <div class="accordion" style="padding:20px; max-width:100%; border-left: 4px solid var(--primary);">
                <h3>Crear Categor√≠a</h3>
                <select id="new-cat-type"><option value="norms">Normativa</option><option value="gov">Gobierno</option></select>
                <input type="text" id="new-cat-name" placeholder="Nombre (ej: Normas de Polic√≠a)">
                <button class="btn btn-primary" onclick="createCat()">Crear</button>
            </div>
            <div class="accordion" style="padding:20px; max-width:100%; margin-top:15px; border-left: 4px solid var(--success);">
                <h3>Publicar √çtem</h3>
                <select id="sel-destiny"></select>
                <input type="text" id="it-title" placeholder="T√≠tulo">
                <textarea id="it-desc" placeholder="Descripci√≥n..."></textarea>
                <input type="text" id="it-img" placeholder="URL Imagen (Opcional)">
                <button class="btn btn-primary" onclick="createItem()">Publicar</button>
            </div>
        </div>

        <div id="t-manage" class="tab-content" style="width:100%; max-width:800px; display:none;">
            <div id="admin-list-norms"></div>
            <div id="admin-list-gov" style="margin-top:20px;"></div>
        </div>

        <div id="t-staff" class="tab-content" style="width:100%; max-width:800px; display:none;">
            <div class="accordion" style="padding:20px; max-width:100%;">
                <h3>Webhook de Logs</h3>
                <input type="text" id="cfg-webhook" placeholder="https://discord.com/api/webhooks/...">
                <button class="btn btn-primary" onclick="saveWebhook()">Guardar Webhook</button>
            </div>
        </div>
    </section>

    <div id="gate-overlay" class="overlay">
        <div class="glass">
            <h3>Acceso Staff</h3>
            <input type="password" id="pass-gate" placeholder="Llave Maestra">
            <button class="btn btn-primary" onclick="checkGate()">Siguiente</button>
            <p onclick="closeOverlays()" style="margin-top:15px; cursor:pointer; opacity:0.5; font-size:12px;">Cerrar</p>
        </div>
    </div>

    <div id="login-overlay" class="overlay">
        <div class="glass">
            <h3 id="user-tag">Identificaci√≥n</h3>
            <input type="text" id="staff-user" placeholder="Tu Nombre">
            <input type="password" id="pass-panel" placeholder="Clave Panel">
            <button class="btn btn-primary" onclick="finalLogin()">Entrar al Sistema</button>
        </div>
    </div>

    <script>
        let db = JSON.parse(localStorage.getItem('esp_dist_db_v2')) || { norms: [], gov: [], webhook: "" };
        let sessionStaff = null;

        function save() { localStorage.setItem('esp_dist_db_v2', JSON.stringify(db)); render(); }

        function showView(id) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById('view-' + id).classList.add('active');
        }

        // LOGS DISCORD
        async function sendLog(title, desc, color = 3447003) {
            if(!db.webhook) return;
            try {
                await fetch(db.webhook, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ embeds: [{ title, description: desc, color, timestamp: new Date() }] })
                });
            } catch(e) { console.log("Error Webhook"); }
        }

        // ACCESO
        function openGate() { document.getElementById('gate-overlay').style.display = 'flex'; }
        function closeOverlays() { document.querySelectorAll('.overlay').forEach(o => o.style.display = 'none'); }

        function checkGate() {
            const p = document.getElementById('pass-gate').value;
            if(p === 'pampiano17') {
                document.getElementById('gate-overlay').style.display = 'none';
                document.getElementById('login-overlay').style.display = 'flex';
            } else {
                sendLog("‚ö†Ô∏è Alerta de Seguridad", "Intento fallido con **Llave Maestra** incorrecta.", 15158332);
                alert("Llave Incorrecta");
            }
        }

        function finalLogin() {
            const u = document.getElementById('staff-user').value;
            const p = document.getElementById('pass-panel').value;
            if(p === 'ESP123' && u) {
                sessionStaff = u;
                closeOverlays();
                showView('admin');
                renderAdmin();
                sendLog("üì• Sesi√≥n Iniciada", `El staff **${u}** ha entrado al panel.`);
            } else {
                sendLog("üö´ Intento de Acceso", `Usuario: **${u || 'Desconocido'}** intent√≥ entrar con clave de panel err√≥nea.`, 15158332);
                alert("Datos incorrectos");
            }
        }

        function logout() {
            sendLog("üì§ Sesi√≥n Cerrada", `El staff **${sessionStaff}** sali√≥ del sistema.`);
            sessionStaff = null;
            location.reload();
        }

        // STAFF PASS
        function askStaffPass() {
            const p = prompt("Introduce Clave de Seguridad:");
            if(p === 'Pampigod') {
                switchTab('t-staff');
            } else {
                sendLog("üîí Alerta Staff", `**${sessionStaff}** fall√≥ la clave de seguridad interna.`, 15158332);
                alert("No autorizado");
            }
        }

        // GESTI√ìN
        function createCat() {
            const t = document.getElementById('new-cat-type').value;
            const n = document.getElementById('new-cat-name').value;
            if(!n) return;
            db[t].push({ name: n, items: [] });
            sendLog("üìÅ Nueva Categor√≠a", `**${sessionStaff}** cre√≥: ${n} (${t})`);
            save(); renderAdmin();
        }

        function createItem() {
            const path = document.getElementById('sel-destiny').value.split('-');
            const t = document.getElementById('it-title').value;
            const d = document.getElementById('it-desc').value;
            const i = document.getElementById('it-img').value;
            if(!t || !d) return;
            db[path[0]][path[1]].items.push({ title: t, desc: d, img: i });
            sendLog("üìù Nuevo √çtem", `**${sessionStaff}** public√≥: **${t}** en ${db[path[0]][path[1]].name}`);
            save(); alert("Publicado");
        }

        function deleteCat(type, idx) {
            if(confirm("¬øEliminar categor√≠a?")) {
                sendLog("üóëÔ∏è Eliminaci√≥n", `**${sessionStaff}** elimin√≥ la categor√≠a: ${db[type][idx].name}`);
                db[type].splice(idx, 1);
                save(); renderAdmin();
            }
        }

        function editCat(type, idx) {
            const n = prompt("Nuevo nombre:", db[type][idx].name);
            if(n) { db[type][idx].name = n; save(); renderAdmin(); }
        }

        function saveWebhook() {
            db.webhook = document.getElementById('cfg-webhook').value;
            save();
            alert("Webhook configurado y guardado.");
            sendLog("üîó Webhook Vinculado", "Este canal ahora recibir√° los logs de Espa√±a District.");
        }

        // RENDERS
        function render() {
            const nR = document.getElementById('render-norms');
            const gR = document.getElementById('render-gov');
            const sel = document.getElementById('sel-destiny');
            nR.innerHTML = ""; gR.innerHTML = ""; sel.innerHTML = "";

            ['norms', 'gov'].forEach(type => {
                db[type].forEach((cat, cIdx) => {
                    const opt = document.createElement('option');
                    opt.value = `${type}-${cIdx}`; opt.innerText = `[${type.toUpperCase()}] ${cat.name}`;
                    sel.appendChild(opt);

                    let itemsHtml = "";
                    cat.items.forEach(it => {
                        itemsHtml += `<div style="padding:15px; border-bottom:1px solid rgba(255,255,255,0.05);">
                            <b style="font-size:16px; color:var(--primary);">${it.title}</b>
                            <p style="color:#94a3b8; font-size:14px; margin-top:8px; line-height:1.5;">${it.desc}</p>
                            ${it.img ? `<img src="${it.img}" style="width:100%; border-radius:10px; margin-top:10px; border: 1px solid rgba(255,255,255,0.1);">` : ''}
                        </div>`;
                    });

                    const box = type === 'norms' ? nR : gR;
                    const accent = type === 'norms' ? 'acc-norms' : 'acc-gov';
                    box.innerHTML += `<div class="accordion ${accent}">
                        <div class="acc-header" onclick="this.parentElement.classList.toggle('open')">${cat.name} <span>‚ñº</span></div>
                        <div class="acc-content">${itemsHtml || '<p style="padding:20px; opacity:0.3;">Sin contenido</p>'}</div>
                    </div>`;
                });
            });
        }

        function renderAdmin() {
            const ln = document.getElementById('admin-list-norms');
            const lg = document.getElementById('admin-list-gov');
            ln.innerHTML = "<h4>Normativas</h4>"; lg.innerHTML = "<h4>Gobierno</h4>";

            ['norms', 'gov'].forEach(type => {
                db[type].forEach((cat, idx) => {
                    const d = document.createElement('div');
                    d.className = "admin-card";
                    d.innerHTML = `<span>${cat.name}</span><div>
                        <button class="btn btn-primary btn-small" onclick="editCat('${type}',${idx})">‚úé</button>
                        <button class="btn btn-danger btn-small" onclick="deleteCat('${type}',${idx})">üóë</button>
                    </div>`;
                    (type === 'norms' ? ln : lg).appendChild(d);
                });
            });
            document.getElementById('cfg-webhook').value = db.webhook;
        }

        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.style.display = 'none');
            document.getElementById(id).style.display = 'block';
        }

        window.onload = render;
    </script>
</body>
</html>
 
